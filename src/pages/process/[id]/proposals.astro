---
import ProcessLayout from "@layouts/ProcessLayout.astro";
import getProcessUrl from "@utils/getProcessUrl";
import { Translator } from '@utils/i18n.js';
import fetchProcessData from '@utils/fetchProcessData';
import ProposalsList from "@components/process/ProposalsList.astro";

const translator = new Translator(Astro.currentLocale || 'en');


const { url } = Astro;
const processId: any = Astro.params.id;
const process = await fetchProcessData(processId);
const pathname = `${Astro.currentLocale === "en" ? "" : `/${Astro.currentLocale}`}${getProcessUrl(process)}`;
if (pathname !== url.pathname)
    return Astro.redirect(pathname);

const proposals = process.proposals ? process.proposals : [];

---

<ProcessLayout process={process}>
  <ProposalsList processId={process._id} proposals={proposals}/>
</ProcessLayout>
